# Releases

This document describes how the release flow looks like and how to create the `helm-broker` release.

## Release process

Every change in the `master` branch which passes all checks creates the `latest` tag and triggers the release.

Every tag with the `vX.Y.Z` pattern that is pushed to the repository triggers a new release.

### Create a release from the master branch

Follow these steps to create a new `helm-broker` release `v0.6.0`:

1. Checkout the `master` branch and pull the latest changes:

    ```
    git checkout master
    git pull
    ```
2. Prepare the release:

    ```
    make VERSION=v0.6.0 cut-release
    ```
This command does the following:
  - Changes the images tag in the `charts/helm-broker/values.yaml` to `v0.6.0`
  - Changes the tags in the documentation links to `v0.6.0`
  - Creates a commit with the changes
  - Creates the `v0.6.0` tag

3. Push the release:

    ```
    git push {remote} v0.6.0
    ```

It triggers the Prow CI release job for Helm Broker.

> **NOTE:** If you want to push the tag to the upstream, run `git push upstream v0.6.0`.

4. After Prow CI job is finished, go to the **Releases** tab where the new release appears. The new branch is available in the **Branches** tab.


### Create a release from the release branch

Follow these steps to create a new `helm-broker` release 0.6.1:

1. Checkout the release branch with the latest changes. For example:

    ```
    git fetch {remote}
    git checkout release-0.6
    git pull
    ```

2. Commit your changes to the `release-0.6` release branch.
>**NOTE:** In order to have a complete changelog, create a Pull Request to the release branch.

3. Prepare the release:

    ```
    make VERSION=v0.6.1 cut-release
    ```
    This command does the following:
      - Changes the images tag in the `charts/helm-broker/values.yaml` to `v0.6.1`
      - Changes the tags in the documentation links to `v0.6.1`
      - Creates a commit with the changes
      - Creates the `v0.6.1` tag

4. Push your changes with the tag:

    ```
    git push {remote} v0.6.1
    ```

5. After Prow CI job is finished, go to the **Releases** tab where the new `v0.6.1` release appears.


## Changelog functionality

Every time you create a new release, the changelog file is generated by the [github_changelog_generator](https://github.com/skywinder/Github-Changelog-Generator). It is automatically added to the release body.
Every changelog file contains a list of Pull Requests and issues from the period between the releases.

If you want to configure the changelog generator in the `.github_changelog_generator` file, read [this](https://github.com/github-changelog-generator/github-changelog-generator#params-file) document.
